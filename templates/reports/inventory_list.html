{% extends 'base.html' %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header bg-{% if title == 'Low Stock Report' %}warning{% else %}danger{% endif %} text-white">
        <div class="d-flex justify-content-between align-items-center">
            <h4 class="mb-0"><i class="fas fa-exclamation-triangle"></i> {{ title }}</h4>
            <div>
                <a href="{% url 'reports:export_inventory_csv' %}?type={% if title == 'Low Stock Report' %}low_stock{% else %}out_of_stock{% endif %}" 
                   class="btn btn-light btn-sm">
                    <i class="fas fa-file-export"></i> Export CSV
                </a>
            </div>
        </div>
    </div>
    <div class="card-body">
        <div class="alert alert-{% if title == 'Low Stock Report' %}warning{% else %}danger{% endif %}">
            <strong>Total Items:</strong> {{ low_stock_items.count }}
            {% if title == 'Low Stock Report' %}
            | <strong>Total Inventory Value:</strong> ₹{{ total_value|floatformat:2 }}
            {% endif %}
        </div>

        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>Category</th>
                        <th>Current Stock</th>
                        <th>Minimum Level</th>
                        <th>Price</th>
                        <th>Value</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for product in low_stock_items %}
                    <tr>
                        <td>
                            <a href="{% url 'products:product_detail' product.id %}">
                                {{ product.name }}
                            </a>
                        </td>
                        <td>{{ product.category|default:"-" }}</td>
                        <td>{{ product.stock }}</td>
                        <td>{{ product.min_stock_level }}</td>
                        <td>₹{{ product.price|floatformat:2 }}</td>
                        <td>₹{{ product.stock|mul:product.price|floatformat:2 }}</td>
                        <td>
                            <span class="badge bg-{% if product.stock == 0 %}danger{% else %}warning{% endif %}">
                                {% if product.stock == 0 %}Out of Stock{% else %}Low Stock{% endif %}
                            </span>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="7" class="text-center text-muted">
                            No {% if title == 'Low Stock Report' %}low stock{% else %}out of stock{% endif %} items found
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}